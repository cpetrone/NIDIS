# Non-Isothermal Diffusion Incremental Step (NIDIS)

These MATLAB code was developed to apply a Non-Isothermal Diffusion Incremental Step model to reconstruct crystal lifetime histories helping to constrain pre-eruptive magmatic processes.

The three pieces of code are used for different:
1) grey_values.m is used to extract greyvalues from images
2) createfit.m and createfitFS.m are used to fit the greyvalues and hence calculate the residence time of crystals. createfit.m is to be used for infinite sources profiles, while createfitFS is to be used with semi-finite sources.

